<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Interactive Component | NYC Crime</title>
  <meta name="description" content="Chapter 5 Interactive Component | NYC Crime" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Interactive Component | NYC Crime" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Interactive Component | NYC Crime" />
  
  
  

<meta name="author" content="Devan Samant" />


<meta name="date" content="2023-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="results.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC Crime</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="proposal.html"><a href="proposal.html"><i class="fa fa-check"></i><b>2</b> Proposal</a>
<ul>
<li class="chapter" data-level="2.1" data-path="proposal.html"><a href="proposal.html#research-topic"><i class="fa fa-check"></i><b>2.1</b> Research topic</a></li>
<li class="chapter" data-level="2.2" data-path="proposal.html"><a href="proposal.html#data-availability"><i class="fa fa-check"></i><b>2.2</b> Data availability</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="proposal.html"><a href="proposal.html#content"><i class="fa fa-check"></i><b>2.2.1</b> <em>Content</em></a></li>
<li class="chapter" data-level="2.2.2" data-path="proposal.html"><a href="proposal.html#who-collects-the-data"><i class="fa fa-check"></i><b>2.2.2</b> <em>Who Collects The Data</em></a></li>
<li class="chapter" data-level="2.2.3" data-path="proposal.html"><a href="proposal.html#format-and-importation"><i class="fa fa-check"></i><b>2.2.3</b> <em>Format and Importation</em></a></li>
<li class="chapter" data-level="2.2.4" data-path="proposal.html"><a href="proposal.html#updates"><i class="fa fa-check"></i><b>2.2.4</b> <em>Updates</em></a></li>
<li class="chapter" data-level="2.2.5" data-path="proposal.html"><a href="proposal.html#expected-challenges"><i class="fa fa-check"></i><b>2.2.5</b> <em>Expected Challenges</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#source"><i class="fa fa-check"></i><b>3.1</b> Source</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data.html"><a href="data.html#content-1"><i class="fa fa-check"></i><b>3.1.1</b> Content</a></li>
<li class="chapter" data-level="3.1.2" data-path="data.html"><a href="data.html#who-collects-the-data-1"><i class="fa fa-check"></i><b>3.1.2</b> Who Collects The Data</a></li>
<li class="chapter" data-level="3.1.3" data-path="data.html"><a href="data.html#format-and-importation-1"><i class="fa fa-check"></i><b>3.1.3</b> Format and Importation</a></li>
<li class="chapter" data-level="3.1.4" data-path="data.html"><a href="data.html#data-updates"><i class="fa fa-check"></i><b>3.1.4</b> Data Updates</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data-transformation-and-cleaning"><i class="fa fa-check"></i><b>3.2</b> Data Transformation and Cleaning</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#data-loading"><i class="fa fa-check"></i><b>3.2.1</b> Data Loading</a></li>
<li class="chapter" data-level="3.2.2" data-path="data.html"><a href="data.html#bucket-crime-types"><i class="fa fa-check"></i><b>3.2.2</b> Bucket Crime Types</a></li>
<li class="chapter" data-level="3.2.3" data-path="data.html"><a href="data.html#datetime-transformation"><i class="fa fa-check"></i><b>3.2.3</b> Date/Time Transformation</a></li>
<li class="chapter" data-level="3.2.4" data-path="data.html"><a href="data.html#geo-location-fields"><i class="fa fa-check"></i><b>3.2.4</b> Geo-Location Fields</a></li>
<li class="chapter" data-level="3.2.5" data-path="data.html"><a href="data.html#other-derivations"><i class="fa fa-check"></i><b>3.2.5</b> Other Derivations</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#filter-table-for-relevance"><i class="fa fa-check"></i><b>3.3</b> Filter Table for Relevance</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#select-and-rename-columns"><i class="fa fa-check"></i><b>3.4</b> Select and Rename Columns</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#missing-value-analysis"><i class="fa fa-check"></i><b>3.5</b> Missing Value Analysis</a></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#interactive-component-datasets"><i class="fa fa-check"></i><b>3.6</b> Interactive Component Datasets</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>4</b> Results</a>
<ul>
<li class="chapter" data-level="4.1" data-path="results.html"><a href="results.html#crime-category-and-demographic-analysis"><i class="fa fa-check"></i><b>4.1</b> Crime Category and Demographic Analysis</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="results.html"><a href="results.html#crime-by-borough"><i class="fa fa-check"></i><b>4.1.1</b> Crime by Borough</a></li>
<li class="chapter" data-level="4.1.2" data-path="results.html"><a href="results.html#race"><i class="fa fa-check"></i><b>4.1.2</b> Race</a></li>
<li class="chapter" data-level="4.1.3" data-path="results.html"><a href="results.html#gender"><i class="fa fa-check"></i><b>4.1.3</b> Gender</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="results.html"><a href="results.html#time-series-analysis"><i class="fa fa-check"></i><b>4.2</b> Time Series Analysis</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="results.html"><a href="results.html#day-of-week"><i class="fa fa-check"></i><b>4.2.1</b> Day of Week</a></li>
<li class="chapter" data-level="4.2.2" data-path="results.html"><a href="results.html#time-of-day"><i class="fa fa-check"></i><b>4.2.2</b> Time of Day</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="results.html"><a href="results.html#location-analysis"><i class="fa fa-check"></i><b>4.3</b> Location Analysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="results.html"><a href="results.html#spatial-distribution-around-columbia"><i class="fa fa-check"></i><b>4.3.1</b> Spatial Distribution Around Columbia</a></li>
<li class="chapter" data-level="4.3.2" data-path="results.html"><a href="results.html#spatial-distribution-around-columbia-by-crime-category"><i class="fa fa-check"></i><b>4.3.2</b> Spatial Distribution Around Columbia by Crime Category</a></li>
<li class="chapter" data-level="4.3.3" data-path="results.html"><a href="results.html#increasing-radius-from-columbia"><i class="fa fa-check"></i><b>4.3.3</b> Increasing Radius from Columbia</a></li>
<li class="chapter" data-level="4.3.4" data-path="results.html"><a href="results.html#cumulative-crime-near-cu"><i class="fa fa-check"></i><b>4.3.4</b> Cumulative Crime Near CU</a></li>
<li class="chapter" data-level="4.3.5" data-path="results.html"><a href="results.html#crime-density"><i class="fa fa-check"></i><b>4.3.5</b> Crime Density</a></li>
<li class="chapter" data-level="4.3.6" data-path="results.html"><a href="results.html#deeper-dive-of-crime-density"><i class="fa fa-check"></i><b>4.3.6</b> Deeper Dive of Crime Density</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>5</b> Interactive Component</a>
<ul>
<li class="chapter" data-level="5.1" data-path="interactive-component.html"><a href="interactive-component.html#interactive-map-of-crime-around-columbia"><i class="fa fa-check"></i><b>5.1</b> Interactive Map of Crime Around Columbia</a></li>
<li class="chapter" data-level="5.2" data-path="interactive-component.html"><a href="interactive-component.html#future-work"><i class="fa fa-check"></i><b>5.2</b> Future Work</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>6</b> Conclusion</a>
<ul>
<li class="chapter" data-level="6.1" data-path="conclusion.html"><a href="conclusion.html#limitations-and-future-work"><i class="fa fa-check"></i><b>6.1</b> Limitations and Future Work</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC Crime</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactive-component" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Interactive Component<a href="interactive-component.html#interactive-component" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The following map contains a list of crimes near Columbia (within 1km). Each dot indicates a reported crime (data filtered per the steps described in the “Data” chapter).</p>
<p>The motivation for this component is to allow a user to select features through a series of buttons and view what crime statistics look like geographically. Try playing with the filters to adjust the amount of reported crime. As shown the previous chapter, more crime occurs at night and when the victim is female.</p>
<p>This chapter uses a special package, ggmap, cited below:</p>
<p>D. Kahle and H. Wickham. ggmap: Spatial Visualization with ggplot2. The R Journal, 5(1), 144-161. URL <a href="http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf" class="uri">http://journal.r-project.org/archive/2013-1/kahle-wickham.pdf</a></p>
<div id="interactive-map-of-crime-around-columbia" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Interactive Map of Crime Around Columbia<a href="interactive-component.html#interactive-map-of-crime-around-columbia" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<title>
My Google Map
</title>
<style>
    #map{
      height:400px;
      width:100%;
    }
  </style>
<p>
Instructions: Please select an option below to filter points on the map and refresh the page to reset. Please be patient while the data renders.
</p>
<p>Victim Gender: <br>
<input type="radio" name="gender" value="All" checked="true">All
<input type="radio" name="gender" value="M">Male
<input type="radio" name="gender" value="F">Female</p>
<p>Time of Day: <br>
<input type="radio" name="timeday" value="All" checked="true">All <br>
<input type="radio" name="timeday" value="Day">Day (6am-6pm) <br>
<input type="radio" name="timeday" value="Night">Night (6pm-6am)</p>
<br>
<b>
<p id="filter_string">
All Data Points (within 1km):
</p>
<p></b></p>
<div id="map">

</div>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script src="https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>
<script type="text/javascript">
    
    var gender = "All";
    var timeday = "All";
    var rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short.csv";
    var filter_string = "All Data Points (within 1km):"
    
    d3.selectAll("input")
      .on("click", function(event) { 
        console.log("clicked radio")
        //var gender = event.currentTarget.value;
        var gender  = d3.select('input[name="gender"]:checked').node().value;
        var timeday = d3.select('input[name="timeday"]:checked').node().value;
        console.log(gender);
        
        if (gender == "All" & timeday=="All") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short.csv";
              d3.selectAll("p#filter_string").text("All Data Points (within 1km):")
              initMap()
          } 
          if (gender == "M" & timeday=="All") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_M.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Male Victim:")
              initMap()
          } 
          if (gender == "F" & timeday=="All") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_F.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Female Victim:")
              initMap()
          }
          if (gender == "All" & timeday=="Day") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_Day.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Day Time:")
              initMap()
          }
          if (gender == "All" & timeday=="Night") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_Night.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Night Time:")
              initMap()
          }
          if (gender == "M" & timeday=="Day") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_MDay.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Male Victim, Day Time:")
              initMap()
          }
          if (gender == "F" & timeday=="Day") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_FDay.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Female Victim, Day Time:")
              initMap()
          }
          if (gender == "M" & timeday=="Night") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_MNight.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Male Victim, Night Time:")
              initMap()
          }
         if (gender == "F" & timeday=="Night") {
              rep_string = "https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short_FNight.csv";
              d3.selectAll("p#filter_string").text("Within 1km, Female Victim, Night Time:")
              initMap()
          }

      })
      
    console.log("test16")
    console.log(rep_string)
    
    
    async function getData(){
    //const rep= await fetch("./NYC_Crime_Group32/data/columbia_short.csv")
    //const rep= await fetch("./data/columbia_short.csv")
    //const rep = await fetch("https://raw.githubusercontent.com/ds4114/NYC_Crime_Group32/main/data/columbia_short.csv")
    const rep = await fetch(rep_string)
    const data= await rep.text();
    console.log(rep_string)
    let fin=[]
    const table=data.split('\n').slice(1)
    table.forEach(row=>{
        const colums=row.split(',');
        tab=[parseFloat(colums[0]), parseFloat(colums[1])]
        //console.log(tab)
        //locations.push(tab)
        fin.push(tab)  
        });
        //console.log(fin)
        return fin
    }
    
    function initMap() {
    
    points =
    getData().then(values => {
    // Print the values of the resolved promise
    values.forEach(value => {
    
    marker = new google.maps.Marker({
        position: new google.maps.LatLng(value[0], value[1]),
        map: map,
        icon: {
          path: google.maps.SymbolPath.CIRCLE,
          fillColor: 'red',
          fillOpacity: 0.2,
          strokeColor: '#00A',
          strokeOpacity: 0.2,
          strokeWeight: 1,
          scale: 3.25
        }
      });
    
    
      } );
     });
  
    var map = new google.maps.Map(document.getElementById('map'), {
      zoom: 14.5,
      center: new google.maps.LatLng(40.807384,-73.963036)
    });
    
    }

  </script>
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC0GcOj8ahJPXgMXEZZ495GP9aHkijZG8U&callback=initMap">
  </script>
</div>
<div id="future-work" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Future Work<a href="interactive-component.html#future-work" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are several changes we have considered:
1.The graph is usable but the alpha-blending on the points does not entirely capture the magnitude of the crime. We were thinking to add an additional component to show total crime counts.
2. There are only limited filters enabled right now but adding more could help a user hone down to a target subset that is customized for them.
3. We had hoped to allow users to select both a “from” and “to” destination but found that was hard to execute and would require some design thinking on how to implement without a user having to type in specific latitude and longitude.
4. We also would like to speed up the efficiency of the program by optimizing how the map draws data points around a location - perhaps down-sampling the data could help and we could expand beyond 1km.
5. We also would like to clean up some of the warnings produced by the code and ggmap as well as catch potential errors that could be thrown.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/edit/main/interactive.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ds4114/NYC_Crime_Group32/blob/main/interactive.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
